CREATE DATABASE NHAHATLON
GO

USE NHAHATLON

CREATE TABLE Node
(
	Id UNIQUEIDENTIFIER NOT NULL DEFAULT NEWSEQUENTIALID(),
	valueX FLOAT NOT NULL,
	valueY FLOAT NOT NULL,
	valueZ FLOAT NOT NULL,
	CONSTRAINT PK_IdNode PRIMARY KEY NONCLUSTERED (Id),
)

CREATE TABLE Face
(
	Id UNIQUEIDENTIFIER NOT NULL DEFAULT NEWSEQUENTIALID(),
	FaceName NVARCHAR(256) NOT NULL,
	CONSTRAINT PK_IdFace PRIMARY KEY NONCLUSTERED (Id),

)

CREATE TABLE Node_Face
(
	IdNode UNIQUEIDENTIFIER NOT NULL,
	IdFace UNIQUEIDENTIFIER NOT NULL,
	SEQ INTEGER NOT NULL,
	CONSTRAINT PK_IdNode_IdFace PRIMARY KEY NONCLUSTERED (IdNode, IdFace),
	CONSTRAINT FK_IdNode_Node_Face FOREIGN KEY (IdNode) REFERENCES Node (Id),
	CONSTRAINT FK_IdFace_Node_Face FOREIGN KEY (IdFace) REFERENCES Face (Id)
)

CREATE TABLE Building
(
	Id UNIQUEIDENTIFIER NOT NULL DEFAULT NEWSEQUENTIALID(),
	BuildingName NVARCHAR(256),
	BuildingAddress NVARCHAR(256),
	BuildingDescription NVARCHAR(256),
	CONSTRAINT PK_IdBuilding PRIMARY KEY NONCLUSTERED (Id),
)


CREATE TABLE Body
(
	Id UNIQUEIDENTIFIER NOT NULL DEFAULT NEWSEQUENTIALID(),
	BodyName NVARCHAR(256),
	BodyDescription NVARCHAR(256),
	Color NVARCHAR(256),
	EdgeColor NVARCHAR(256),
	IdBuilding UNIQUEIDENTIFIER,
	CONSTRAINT PK_IdBody PRIMARY KEY NONCLUSTERED (Id),
	CONSTRAINT FK_IdBuilding_Body FOREIGN KEY (IdBuilding) REFERENCES Building (Id),
)

CREATE TABLE Prism
(
	Id UNIQUEIDENTIFIER NOT NULL DEFAULT NEWSEQUENTIALID(),
	IdFace UNIQUEIDENTIFIER,
	Height FLOAT,
	IdBody UNIQUEIDENTIFIER,
	CONSTRAINT PK_IdPrism PRIMARY KEY NONCLUSTERED (Id),
	CONSTRAINT FK_IdFace_Prism FOREIGN KEY (IdFace) REFERENCES Face (Id),
	CONSTRAINT FK_IdBody_Prism FOREIGN KEY (IdBody) REFERENCES Body (Id),
)

CREATE TABLE BodyComp
(
	Id UNIQUEIDENTIFIER NOT NULL DEFAULT NEWSEQUENTIALID(),
	IdBody UNIQUEIDENTIFIER,
	CONSTRAINT PK_IdBodyComp PRIMARY KEY NONCLUSTERED (Id),
	CONSTRAINT FK_IdBody_BodyComp FOREIGN KEY (IdBody) REFERENCES Body(Id)
)

CREATE TABLE BodyComp_Face
(
	IdBodyComp UNIQUEIDENTIFIER NOT NULL,
	IdFace UNIQUEIDENTIFIER NOT NULL,
	CONSTRAINT PK_IdBodyComp_Face PRIMARY KEY NONCLUSTERED (IdBodyComp, IdFace),
	CONSTRAINT FK_IdFace_BodyComp_Face FOREIGN KEY (IdFace) REFERENCES Face (Id),
	CONSTRAINT FK_IdBodyComp_BodyComp_Face FOREIGN KEY (IdBodyComp) REFERENCES BodyComp (Id),
)